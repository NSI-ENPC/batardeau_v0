// ------------------------------------------ //
//                                            //
//              Batardeau Engine              //
//                   *---*                    //
//                                            //
// Eng: NSI                                   //
// Ent: Terrasol (Setec)                      //
// Ver: 0.2                                   //
// Dat: 2024/08/03                            //
//                                            //
// ------------------------------------------ //

// Ce code constitue une première implémentation
// d'un code de calcul par éléments finis mettant
// en jeu des éléments de coque mince rectangulaires.

// Ce code est un miroir de celui développé en Python,
// conçu dans l'objectif de mesurer le gain de performances
// rendu possible par l'utilisation de C++.

// Pour cette première version, il n'intègre pas d'éléments
// annexes, tels que des poutres et des ancrages.

// Versions:
// +++++++++
//      v0.1 - Première implémentation du code pour coque seule, retranscription du code Python.
//      v0.2 - Amélioration de l'étape d'assemblage, en internalisant la multiplication de rotation.
//             On passe de 25% à 6-7% en part de temps pour l'assemblage. 



// I - Importation des librairies nécessaires
// ------------------------------------------

#include <iostream>
#include <fstream>
#include <Eigen/Dense>
#include <Eigen/Sparse>
#include <cmath>

using namespace Eigen;
using namespace std;

#include <chrono>
using namespace std::chrono;

// II - Création des classes adaptées
// ----------------------------------

// a) Classe "vecteur" customisée

class vecteur{
    public:
    double dx,dy,dz;
    vecteur(){};
    vecteur(double i, double j, double k){
        dx = i;
        dy = j;
        dz = k;
    };
    double norm(){
        return sqrt(dx*dx + dy*dy + dz*dz);
    };
    vecteur normalize(){
        vecteur vec;
        double norme = sqrt(dx*dx + dy*dy + dz*dz);
        vec.dx=dx/norme;vec.dy=dy/norme;vec.dz=dz/norme;
        return vec;
    };
    double Pscalar(vecteur vec){
        return vec.dx*dx + vec.dy*dy + vec.dz*dz;
    };
    vecteur Pvector(vecteur vec){
        return vecteur(dy*vec.dz-dz*vec.dy,dz*vec.dx-dx*vec.dz,dx*vec.dy-dy*vec.dx);
    };
};

vecteur eX(1,0,0);
vecteur eY(0,1,0);
vecteur eZ(0,0,1);

// b) Classe "Point" customisée

class point{
    public:
    double x,y,z;
    int no, ktz;
    point(){};
    point(double i, double j, double k, int no_in, int ktz_in){
        x=i;y=j;z=k;no=no_in;ktz=ktz_in;
    }
    point(double i, double j, double k){
        x=i;y=j;z=k;no=-1;ktz=0;
    }
    vecteur vectorTo(point pt){
        return vecteur(pt.x-x,pt.y-y,pt.z-z);
    };
    vecteur vectorFrom(point pt){
        return vecteur(x-pt.x,y-pt.y,z-pt.z);
    };
    point interpolTo(point pt, double taux, int no_in, int ktz_in){
        return point(x+taux*(pt.x-x),y+taux*(pt.y-y),z+taux*(pt.z-z),no_in,ktz_in);
    }
};

// c) Classe face customisée

Matrix3d m3_0;
Matrix3d m3_1;
Matrix3d z3 = Matrix3d::Constant(0);

class face{
    public:
    point pt1, pt2, pt3, pt4, ptC;
    double a,b;
    face(){};
    face(point p1, point p2, point p3, point p4){
        pt1=p1;pt2=p2;pt3=p3;pt4=p4;
        ptC = point(0.5*(pt1.x+pt2.x),0.5*(pt1.y+pt2.y),0.5*(pt1.z+pt2.z));
        a = (p1.vectorTo(p2)).norm();
        b = (p1.vectorTo(p4)).norm();
        
    };
    // Cette méthode renvoie la matrice de passage de la base locale dans la base globale
    Matrix3d local2global(){
        vecteur ex = (pt1.vectorTo(pt2)).normalize();
        vecteur ey = (pt1.vectorTo(pt4)).normalize();
        vecteur ez = ex.Pvector(ey);

        m3_0    << ex.Pscalar(eX), ey.Pscalar(eX), ez.Pscalar(eX),
                ex.Pscalar(eY), ey.Pscalar(eY), ez.Pscalar(eY),
                ex.Pscalar(eZ), ey.Pscalar(eZ), ez.Pscalar(eZ);
        return m3_0;
};

};

typedef Triplet<double> T;

// III - Création des fonctions d'assemblage appropriées
// -----------------------------------------------------

MatrixXd m24_0(24,24);
MatrixXd m24_1(24,24);
MatrixXd m24_2(24,24);

// Cette fonction prend en entrée un élément, le module d'Young E, le coefficient de Poisson nu et l'épaisseur t
// Elle ajoute les triplets de la matrice de raideur élémentaire dans la base globale dans la liste totale des triplets.
void global_stiffness_elem(vector<T> &lst, face element, double E, double nu, double t){
    double B = E*t/(1-nu*nu);
    double D = E*t*t*t/(12*(1-nu*nu));
    double a = element.a;
    double b = element.b;
    int ktz1=element.pt1.ktz;int ktz2=element.pt2.ktz;int ktz3=element.pt3.ktz;int ktz4=element.pt4.ktz;

    m3_1 = element.local2global();
    double r11=m3_1(0,0);double r12=m3_1(0,1);double r13=m3_1(0,2);
    double r21=m3_1(1,0);double r22=m3_1(1,1);double r23=m3_1(1,2);
    double r31=m3_1(2,0);double r32=m3_1(2,1);double r33=m3_1(2,2);


    m24_2 <<D*(r13*r13)*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r11*(B*r12*(nu/8+1/8)+B*r11*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r12*(B*r11*(nu/8+1/8)+B*r12*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),D*r13*r23*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r11*(B*r22*(nu/8+1/8)+B*r21*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r12*(B*r21*(nu/8+1/8)+B*r22*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),D*r13*r33*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r11*(B*r32*(nu/8+1/8)+B*r31*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r12*(B*r31*(nu/8+1/8)+B*r32*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),r13*(D*r11*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r12*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a))),r13*(D*r21*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r22*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a))),r13*(D*r31*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r32*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a))),D*(r13*r13)*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r11*(B*r12*(3*nu/8-1/8)+B*r11*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r12*(B*r11*(1/8-3*nu/8)+B*r12*((a*a)+(b*b)*(nu-1))/(6*a*b)),D*r13*r23*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r11*(B*r22*(3*nu/8-1/8)+B*r21*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r12*(B*r21*(1/8-3*nu/8)+B*r22*((a*a)+(b*b)*(nu-1))/(6*a*b)),D*r13*r33*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r11*(B*r32*(3*nu/8-1/8)+B*r31*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r12*(B*r31*(1/8-3*nu/8)+B*r32*((a*a)+(b*b)*(nu-1))/(6*a*b)),r13*(D*r11*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r12*(nu/(5*b)-1/(5*b)-2*b/(a*a))),r13*(D*r21*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r22*(nu/(5*b)-1/(5*b)-2*b/(a*a))),r13*(D*r31*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r32*(nu/(5*b)-1/(5*b)-2*b/(a*a))),D*(r13*r13)*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r11*(B*r12*(-nu/8-1/8)+B*r11*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r12*(B*r11*(-nu/8-1/8)+B*r12*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),D*r13*r23*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r11*(B*r22*(-nu/8-1/8)+B*r21*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r12*(B*r21*(-nu/8-1/8)+B*r22*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),D*r13*r33*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r11*(B*r32*(-nu/8-1/8)+B*r31*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r12*(B*r31*(-nu/8-1/8)+B*r32*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),r13*(D*r11*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r12*(-nu/(5*b)+1/(5*b)-b/(a*a))),r13*(D*r21*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r22*(-nu/(5*b)+1/(5*b)-b/(a*a))),r13*(D*r31*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r32*(-nu/(5*b)+1/(5*b)-b/(a*a))),D*(r13*r13)*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r11*(B*r12*(1/8-3*nu/8)+B*r11*((a*a)*(nu-1)+(b*b))/(6*a*b))+r12*(B*r11*(3*nu/8-1/8)+B*r12*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),D*r13*r23*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r11*(B*r22*(1/8-3*nu/8)+B*r21*((a*a)*(nu-1)+(b*b))/(6*a*b))+r12*(B*r21*(3*nu/8-1/8)+B*r22*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),D*r13*r33*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r11*(B*r32*(1/8-3*nu/8)+B*r31*((a*a)*(nu-1)+(b*b))/(6*a*b))+r12*(B*r31*(3*nu/8-1/8)+B*r32*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),r13*(D*r11*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r12*(4*nu/(5*b)+1/(5*b)-b/(a*a))),r13*(D*r21*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r22*(4*nu/(5*b)+1/(5*b)-b/(a*a))),r13*(D*r31*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r32*(4*nu/(5*b)+1/(5*b)-b/(a*a))),
            D*r13*r23*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r21*(B*r12*(nu/8+1/8)+B*r11*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r22*(B*r11*(nu/8+1/8)+B*r12*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),D*(r23*r23)*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r21*(B*r22*(nu/8+1/8)+B*r21*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r22*(B*r21*(nu/8+1/8)+B*r22*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),D*r23*r33*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r21*(B*r32*(nu/8+1/8)+B*r31*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r22*(B*r31*(nu/8+1/8)+B*r32*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),r23*(D*r11*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r12*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a))),r23*(D*r21*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r22*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a))),r23*(D*r31*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r32*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a))),D*r13*r23*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r21*(B*r12*(3*nu/8-1/8)+B*r11*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r22*(B*r11*(1/8-3*nu/8)+B*r12*((a*a)+(b*b)*(nu-1))/(6*a*b)),D*(r23*r23)*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r21*(B*r22*(3*nu/8-1/8)+B*r21*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r22*(B*r21*(1/8-3*nu/8)+B*r22*((a*a)+(b*b)*(nu-1))/(6*a*b)),D*r23*r33*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r21*(B*r32*(3*nu/8-1/8)+B*r31*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r22*(B*r31*(1/8-3*nu/8)+B*r32*((a*a)+(b*b)*(nu-1))/(6*a*b)),r23*(D*r11*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r12*(nu/(5*b)-1/(5*b)-2*b/(a*a))),r23*(D*r21*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r22*(nu/(5*b)-1/(5*b)-2*b/(a*a))),r23*(D*r31*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r32*(nu/(5*b)-1/(5*b)-2*b/(a*a))),D*r13*r23*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r21*(B*r12*(-nu/8-1/8)+B*r11*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r22*(B*r11*(-nu/8-1/8)+B*r12*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),D*(r23*r23)*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r21*(B*r22*(-nu/8-1/8)+B*r21*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r22*(B*r21*(-nu/8-1/8)+B*r22*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),D*r23*r33*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r21*(B*r32*(-nu/8-1/8)+B*r31*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r22*(B*r31*(-nu/8-1/8)+B*r32*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),r23*(D*r11*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r12*(-nu/(5*b)+1/(5*b)-b/(a*a))),r23*(D*r21*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r22*(-nu/(5*b)+1/(5*b)-b/(a*a))),r23*(D*r31*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r32*(-nu/(5*b)+1/(5*b)-b/(a*a))),D*r13*r23*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r21*(B*r12*(1/8-3*nu/8)+B*r11*((a*a)*(nu-1)+(b*b))/(6*a*b))+r22*(B*r11*(3*nu/8-1/8)+B*r12*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),D*(r23*r23)*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r21*(B*r22*(1/8-3*nu/8)+B*r21*((a*a)*(nu-1)+(b*b))/(6*a*b))+r22*(B*r21*(3*nu/8-1/8)+B*r22*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),D*r23*r33*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r21*(B*r32*(1/8-3*nu/8)+B*r31*((a*a)*(nu-1)+(b*b))/(6*a*b))+r22*(B*r31*(3*nu/8-1/8)+B*r32*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),r23*(D*r11*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r12*(4*nu/(5*b)+1/(5*b)-b/(a*a))),r23*(D*r21*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r22*(4*nu/(5*b)+1/(5*b)-b/(a*a))),r23*(D*r31*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r32*(4*nu/(5*b)+1/(5*b)-b/(a*a))),
            D*r13*r33*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r31*(B*r12*(nu/8+1/8)+B*r11*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r32*(B*r11*(nu/8+1/8)+B*r12*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),D*r23*r33*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r31*(B*r22*(nu/8+1/8)+B*r21*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r32*(B*r21*(nu/8+1/8)+B*r22*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),D*(r33*r33)*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r31*(B*r32*(nu/8+1/8)+B*r31*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r32*(B*r31*(nu/8+1/8)+B*r32*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),r33*(D*r11*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r12*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a))),r33*(D*r21*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r22*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a))),r33*(D*r31*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r32*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a))),D*r13*r33*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r31*(B*r12*(3*nu/8-1/8)+B*r11*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r32*(B*r11*(1/8-3*nu/8)+B*r12*((a*a)+(b*b)*(nu-1))/(6*a*b)),D*r23*r33*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r31*(B*r22*(3*nu/8-1/8)+B*r21*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r32*(B*r21*(1/8-3*nu/8)+B*r22*((a*a)+(b*b)*(nu-1))/(6*a*b)),D*(r33*r33)*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r31*(B*r32*(3*nu/8-1/8)+B*r31*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r32*(B*r31*(1/8-3*nu/8)+B*r32*((a*a)+(b*b)*(nu-1))/(6*a*b)),r33*(D*r11*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r12*(nu/(5*b)-1/(5*b)-2*b/(a*a))),r33*(D*r21*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r22*(nu/(5*b)-1/(5*b)-2*b/(a*a))),r33*(D*r31*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r32*(nu/(5*b)-1/(5*b)-2*b/(a*a))),D*r13*r33*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r31*(B*r12*(-nu/8-1/8)+B*r11*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r32*(B*r11*(-nu/8-1/8)+B*r12*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),D*r23*r33*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r31*(B*r22*(-nu/8-1/8)+B*r21*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r32*(B*r21*(-nu/8-1/8)+B*r22*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),D*(r33*r33)*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r31*(B*r32*(-nu/8-1/8)+B*r31*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r32*(B*r31*(-nu/8-1/8)+B*r32*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),r33*(D*r11*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r12*(-nu/(5*b)+1/(5*b)-b/(a*a))),r33*(D*r21*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r22*(-nu/(5*b)+1/(5*b)-b/(a*a))),r33*(D*r31*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r32*(-nu/(5*b)+1/(5*b)-b/(a*a))),D*r13*r33*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r31*(B*r12*(1/8-3*nu/8)+B*r11*((a*a)*(nu-1)+(b*b))/(6*a*b))+r32*(B*r11*(3*nu/8-1/8)+B*r12*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),D*r23*r33*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r31*(B*r22*(1/8-3*nu/8)+B*r21*((a*a)*(nu-1)+(b*b))/(6*a*b))+r32*(B*r21*(3*nu/8-1/8)+B*r22*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),D*(r33*r33)*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r31*(B*r32*(1/8-3*nu/8)+B*r31*((a*a)*(nu-1)+(b*b))/(6*a*b))+r32*(B*r31*(3*nu/8-1/8)+B*r32*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),r33*(D*r11*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r12*(4*nu/(5*b)+1/(5*b)-b/(a*a))),r33*(D*r21*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r22*(4*nu/(5*b)+1/(5*b)-b/(a*a))),r33*(D*r31*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r32*(4*nu/(5*b)+1/(5*b)-b/(a*a))),
            D*r11*r13*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r12*r13*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r11*r23*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r12*r23*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r11*r33*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r12*r33*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a)),ktz1*(r13*r13)+r11*(-D*nu*r12+D*r11*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r12*(-D*nu*r11+D*r12*(-4*(a*a)*nu+4*(a*a)+20*(b*b))/(15*a*b)),ktz1*r13*r23+r11*(-D*nu*r22+D*r21*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r12*(-D*nu*r21+D*r22*(-4*(a*a)*nu+4*(a*a)+20*(b*b))/(15*a*b)),ktz1*r13*r33+r11*(-D*nu*r32+D*r31*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r12*(-D*nu*r31+D*r32*(-4*(a*a)*nu+4*(a*a)+20*(b*b))/(15*a*b)),D*r11*r13*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r12*r13*(-nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r11*r23*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r12*r23*(-nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r11*r33*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r12*r33*(-nu/(5*b)+1/(5*b)+2*b/(a*a)),D*(r11*r11)*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*(r12*r12)*((a*a)*nu-(a*a)+10*(b*b))/(15*a*b),D*r11*r21*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*r12*r22*((a*a)*nu-(a*a)+10*(b*b))/(15*a*b),D*r11*r31*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*r12*r32*((a*a)*nu-(a*a)+10*(b*b))/(15*a*b),D*r11*r13*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r12*r13*(nu/(5*b)-1/(5*b)+b/(a*a)),D*r11*r23*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r12*r23*(nu/(5*b)-1/(5*b)+b/(a*a)),D*r11*r33*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r12*r33*(nu/(5*b)-1/(5*b)+b/(a*a)),D*(r11*r11)*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*(r12*r12)*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*r11*r21*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*r12*r22*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*r11*r31*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*r12*r32*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*r11*r13*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r12*r13*(4*nu/(5*b)+1/(5*b)-b/(a*a)),D*r11*r23*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r12*r23*(4*nu/(5*b)+1/(5*b)-b/(a*a)),D*r11*r33*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r12*r33*(4*nu/(5*b)+1/(5*b)-b/(a*a)),D*(r11*r11)*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*(r12*r12)*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r11*r21*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*r12*r22*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r11*r31*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*r12*r32*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),
            D*r13*r21*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r13*r22*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r21*r23*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r22*r23*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r21*r33*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r22*r33*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a)),ktz1*r13*r23+r21*(-D*nu*r12+D*r11*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r22*(-D*nu*r11+D*r12*(-4*(a*a)*nu+4*(a*a)+20*(b*b))/(15*a*b)),ktz1*(r23*r23)+r21*(-D*nu*r22+D*r21*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r22*(-D*nu*r21+D*r22*(-4*(a*a)*nu+4*(a*a)+20*(b*b))/(15*a*b)),ktz1*r23*r33+r21*(-D*nu*r32+D*r31*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r22*(-D*nu*r31+D*r32*(-4*(a*a)*nu+4*(a*a)+20*(b*b))/(15*a*b)),D*r13*r21*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r13*r22*(-nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r21*r23*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r22*r23*(-nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r21*r33*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r22*r33*(-nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r11*r21*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*r12*r22*((a*a)*nu-(a*a)+10*(b*b))/(15*a*b),D*(r21*r21)*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*(r22*r22)*((a*a)*nu-(a*a)+10*(b*b))/(15*a*b),D*r21*r31*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*r22*r32*((a*a)*nu-(a*a)+10*(b*b))/(15*a*b),D*r13*r21*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r13*r22*(nu/(5*b)-1/(5*b)+b/(a*a)),D*r21*r23*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r22*r23*(nu/(5*b)-1/(5*b)+b/(a*a)),D*r21*r33*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r22*r33*(nu/(5*b)-1/(5*b)+b/(a*a)),D*r11*r21*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*r12*r22*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*(r21*r21)*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*(r22*r22)*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*r21*r31*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*r22*r32*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*r13*r21*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r13*r22*(4*nu/(5*b)+1/(5*b)-b/(a*a)),D*r21*r23*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r22*r23*(4*nu/(5*b)+1/(5*b)-b/(a*a)),D*r21*r33*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r22*r33*(4*nu/(5*b)+1/(5*b)-b/(a*a)),D*r11*r21*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*r12*r22*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*(r21*r21)*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*(r22*r22)*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r21*r31*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*r22*r32*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),
            D*r13*r31*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r13*r32*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r23*r31*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r23*r32*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r31*r33*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r32*r33*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a)),ktz1*r13*r33+r31*(-D*nu*r12+D*r11*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r32*(-D*nu*r11+D*r12*(-4*(a*a)*nu+4*(a*a)+20*(b*b))/(15*a*b)),ktz1*r23*r33+r31*(-D*nu*r22+D*r21*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r32*(-D*nu*r21+D*r22*(-4*(a*a)*nu+4*(a*a)+20*(b*b))/(15*a*b)),ktz1*(r33*r33)+r31*(-D*nu*r32+D*r31*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r32*(-D*nu*r31+D*r32*(-4*(a*a)*nu+4*(a*a)+20*(b*b))/(15*a*b)),D*r13*r31*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r13*r32*(-nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r23*r31*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r23*r32*(-nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r31*r33*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r32*r33*(-nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r11*r31*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*r12*r32*((a*a)*nu-(a*a)+10*(b*b))/(15*a*b),D*r21*r31*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*r22*r32*((a*a)*nu-(a*a)+10*(b*b))/(15*a*b),D*(r31*r31)*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*(r32*r32)*((a*a)*nu-(a*a)+10*(b*b))/(15*a*b),D*r13*r31*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r13*r32*(nu/(5*b)-1/(5*b)+b/(a*a)),D*r23*r31*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r23*r32*(nu/(5*b)-1/(5*b)+b/(a*a)),D*r31*r33*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r32*r33*(nu/(5*b)-1/(5*b)+b/(a*a)),D*r11*r31*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*r12*r32*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*r21*r31*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*r22*r32*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*(r31*r31)*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*(r32*r32)*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*r13*r31*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r13*r32*(4*nu/(5*b)+1/(5*b)-b/(a*a)),D*r23*r31*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r23*r32*(4*nu/(5*b)+1/(5*b)-b/(a*a)),D*r31*r33*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r32*r33*(4*nu/(5*b)+1/(5*b)-b/(a*a)),D*r11*r31*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*r12*r32*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r21*r31*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*r22*r32*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*(r31*r31)*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*(r32*r32)*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),
            D*(r13*r13)*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r11*(B*r12*(1/8-3*nu/8)+B*r11*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r12*(B*r11*(3*nu/8-1/8)+B*r12*((a*a)+(b*b)*(nu-1))/(6*a*b)),D*r13*r23*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r11*(B*r22*(1/8-3*nu/8)+B*r21*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r12*(B*r21*(3*nu/8-1/8)+B*r22*((a*a)+(b*b)*(nu-1))/(6*a*b)),D*r13*r33*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r11*(B*r32*(1/8-3*nu/8)+B*r31*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r12*(B*r31*(3*nu/8-1/8)+B*r32*((a*a)+(b*b)*(nu-1))/(6*a*b)),r13*(D*r11*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r12*(-nu/(5*b)+1/(5*b)+2*b/(a*a))),r13*(D*r21*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r22*(-nu/(5*b)+1/(5*b)+2*b/(a*a))),r13*(D*r31*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r32*(-nu/(5*b)+1/(5*b)+2*b/(a*a))),D*(r13*r13)*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r11*(B*r12*(-nu/8-1/8)+B*r11*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r12*(B*r11*(-nu/8-1/8)+B*r12*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),D*r13*r23*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r11*(B*r22*(-nu/8-1/8)+B*r21*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r12*(B*r21*(-nu/8-1/8)+B*r22*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),D*r13*r33*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r11*(B*r32*(-nu/8-1/8)+B*r31*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r12*(B*r31*(-nu/8-1/8)+B*r32*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),r13*(D*r11*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r12*(4*nu/(5*b)+1/(5*b)+2*b/(a*a))),r13*(D*r21*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r22*(4*nu/(5*b)+1/(5*b)+2*b/(a*a))),r13*(D*r31*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r32*(4*nu/(5*b)+1/(5*b)+2*b/(a*a))),D*(r13*r13)*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r11*(B*r12*(3*nu/8-1/8)+B*r11*((a*a)*(nu-1)+(b*b))/(6*a*b))+r12*(B*r11*(1/8-3*nu/8)+B*r12*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),D*r13*r23*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r11*(B*r22*(3*nu/8-1/8)+B*r21*((a*a)*(nu-1)+(b*b))/(6*a*b))+r12*(B*r21*(1/8-3*nu/8)+B*r22*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),D*r13*r33*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r11*(B*r32*(3*nu/8-1/8)+B*r31*((a*a)*(nu-1)+(b*b))/(6*a*b))+r12*(B*r31*(1/8-3*nu/8)+B*r32*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),r13*(D*r11*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r12*(-4*nu/(5*b)-1/(5*b)+b/(a*a))),r13*(D*r21*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r22*(-4*nu/(5*b)-1/(5*b)+b/(a*a))),r13*(D*r31*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r32*(-4*nu/(5*b)-1/(5*b)+b/(a*a))),D*(r13*r13)*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r11*(B*r12*(nu/8+1/8)+B*r11*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r12*(B*r11*(nu/8+1/8)+B*r12*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),D*r13*r23*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r11*(B*r22*(nu/8+1/8)+B*r21*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r12*(B*r21*(nu/8+1/8)+B*r22*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),D*r13*r33*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r11*(B*r32*(nu/8+1/8)+B*r31*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r12*(B*r31*(nu/8+1/8)+B*r32*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),r13*(D*r11*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r12*(nu/(5*b)-1/(5*b)+b/(a*a))),r13*(D*r21*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r22*(nu/(5*b)-1/(5*b)+b/(a*a))),r13*(D*r31*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r32*(nu/(5*b)-1/(5*b)+b/(a*a))),
            D*r13*r23*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r21*(B*r12*(1/8-3*nu/8)+B*r11*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r22*(B*r11*(3*nu/8-1/8)+B*r12*((a*a)+(b*b)*(nu-1))/(6*a*b)),D*(r23*r23)*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r21*(B*r22*(1/8-3*nu/8)+B*r21*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r22*(B*r21*(3*nu/8-1/8)+B*r22*((a*a)+(b*b)*(nu-1))/(6*a*b)),D*r23*r33*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r21*(B*r32*(1/8-3*nu/8)+B*r31*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r22*(B*r31*(3*nu/8-1/8)+B*r32*((a*a)+(b*b)*(nu-1))/(6*a*b)),r23*(D*r11*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r12*(-nu/(5*b)+1/(5*b)+2*b/(a*a))),r23*(D*r21*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r22*(-nu/(5*b)+1/(5*b)+2*b/(a*a))),r23*(D*r31*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r32*(-nu/(5*b)+1/(5*b)+2*b/(a*a))),D*r13*r23*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r21*(B*r12*(-nu/8-1/8)+B*r11*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r22*(B*r11*(-nu/8-1/8)+B*r12*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),D*(r23*r23)*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r21*(B*r22*(-nu/8-1/8)+B*r21*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r22*(B*r21*(-nu/8-1/8)+B*r22*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),D*r23*r33*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r21*(B*r32*(-nu/8-1/8)+B*r31*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r22*(B*r31*(-nu/8-1/8)+B*r32*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),r23*(D*r11*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r12*(4*nu/(5*b)+1/(5*b)+2*b/(a*a))),r23*(D*r21*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r22*(4*nu/(5*b)+1/(5*b)+2*b/(a*a))),r23*(D*r31*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r32*(4*nu/(5*b)+1/(5*b)+2*b/(a*a))),D*r13*r23*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r21*(B*r12*(3*nu/8-1/8)+B*r11*((a*a)*(nu-1)+(b*b))/(6*a*b))+r22*(B*r11*(1/8-3*nu/8)+B*r12*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),D*(r23*r23)*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r21*(B*r22*(3*nu/8-1/8)+B*r21*((a*a)*(nu-1)+(b*b))/(6*a*b))+r22*(B*r21*(1/8-3*nu/8)+B*r22*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),D*r23*r33*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r21*(B*r32*(3*nu/8-1/8)+B*r31*((a*a)*(nu-1)+(b*b))/(6*a*b))+r22*(B*r31*(1/8-3*nu/8)+B*r32*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),r23*(D*r11*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r12*(-4*nu/(5*b)-1/(5*b)+b/(a*a))),r23*(D*r21*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r22*(-4*nu/(5*b)-1/(5*b)+b/(a*a))),r23*(D*r31*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r32*(-4*nu/(5*b)-1/(5*b)+b/(a*a))),D*r13*r23*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r21*(B*r12*(nu/8+1/8)+B*r11*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r22*(B*r11*(nu/8+1/8)+B*r12*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),D*(r23*r23)*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r21*(B*r22*(nu/8+1/8)+B*r21*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r22*(B*r21*(nu/8+1/8)+B*r22*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),D*r23*r33*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r21*(B*r32*(nu/8+1/8)+B*r31*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r22*(B*r31*(nu/8+1/8)+B*r32*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),r23*(D*r11*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r12*(nu/(5*b)-1/(5*b)+b/(a*a))),r23*(D*r21*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r22*(nu/(5*b)-1/(5*b)+b/(a*a))),r23*(D*r31*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r32*(nu/(5*b)-1/(5*b)+b/(a*a))),
            D*r13*r33*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r31*(B*r12*(1/8-3*nu/8)+B*r11*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r32*(B*r11*(3*nu/8-1/8)+B*r12*((a*a)+(b*b)*(nu-1))/(6*a*b)),D*r23*r33*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r31*(B*r22*(1/8-3*nu/8)+B*r21*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r32*(B*r21*(3*nu/8-1/8)+B*r22*((a*a)+(b*b)*(nu-1))/(6*a*b)),D*(r33*r33)*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r31*(B*r32*(1/8-3*nu/8)+B*r31*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r32*(B*r31*(3*nu/8-1/8)+B*r32*((a*a)+(b*b)*(nu-1))/(6*a*b)),r33*(D*r11*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r12*(-nu/(5*b)+1/(5*b)+2*b/(a*a))),r33*(D*r21*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r22*(-nu/(5*b)+1/(5*b)+2*b/(a*a))),r33*(D*r31*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r32*(-nu/(5*b)+1/(5*b)+2*b/(a*a))),D*r13*r33*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r31*(B*r12*(-nu/8-1/8)+B*r11*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r32*(B*r11*(-nu/8-1/8)+B*r12*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),D*r23*r33*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r31*(B*r22*(-nu/8-1/8)+B*r21*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r32*(B*r21*(-nu/8-1/8)+B*r22*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),D*(r33*r33)*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r31*(B*r32*(-nu/8-1/8)+B*r31*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r32*(B*r31*(-nu/8-1/8)+B*r32*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),r33*(D*r11*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r12*(4*nu/(5*b)+1/(5*b)+2*b/(a*a))),r33*(D*r21*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r22*(4*nu/(5*b)+1/(5*b)+2*b/(a*a))),r33*(D*r31*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r32*(4*nu/(5*b)+1/(5*b)+2*b/(a*a))),D*r13*r33*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r31*(B*r12*(3*nu/8-1/8)+B*r11*((a*a)*(nu-1)+(b*b))/(6*a*b))+r32*(B*r11*(1/8-3*nu/8)+B*r12*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),D*r23*r33*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r31*(B*r22*(3*nu/8-1/8)+B*r21*((a*a)*(nu-1)+(b*b))/(6*a*b))+r32*(B*r21*(1/8-3*nu/8)+B*r22*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),D*(r33*r33)*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r31*(B*r32*(3*nu/8-1/8)+B*r31*((a*a)*(nu-1)+(b*b))/(6*a*b))+r32*(B*r31*(1/8-3*nu/8)+B*r32*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),r33*(D*r11*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r12*(-4*nu/(5*b)-1/(5*b)+b/(a*a))),r33*(D*r21*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r22*(-4*nu/(5*b)-1/(5*b)+b/(a*a))),r33*(D*r31*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r32*(-4*nu/(5*b)-1/(5*b)+b/(a*a))),D*r13*r33*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r31*(B*r12*(nu/8+1/8)+B*r11*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r32*(B*r11*(nu/8+1/8)+B*r12*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),D*r23*r33*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r31*(B*r22*(nu/8+1/8)+B*r21*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r32*(B*r21*(nu/8+1/8)+B*r22*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),D*(r33*r33)*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r31*(B*r32*(nu/8+1/8)+B*r31*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r32*(B*r31*(nu/8+1/8)+B*r32*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),r33*(D*r11*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r12*(nu/(5*b)-1/(5*b)+b/(a*a))),r33*(D*r21*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r22*(nu/(5*b)-1/(5*b)+b/(a*a))),r33*(D*r31*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r32*(nu/(5*b)-1/(5*b)+b/(a*a))),
            D*r11*r13*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r12*r13*(nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r11*r23*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r12*r23*(nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r11*r33*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r12*r33*(nu/(5*b)-1/(5*b)-2*b/(a*a)),D*(r11*r11)*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*(r12*r12)*((a*a)*nu-(a*a)+10*(b*b))/(15*a*b),D*r11*r21*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*r12*r22*((a*a)*nu-(a*a)+10*(b*b))/(15*a*b),D*r11*r31*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*r12*r32*((a*a)*nu-(a*a)+10*(b*b))/(15*a*b),D*r11*r13*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r12*r13*(4*nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r11*r23*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r12*r23*(4*nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r11*r33*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r12*r33*(4*nu/(5*b)+1/(5*b)+2*b/(a*a)),ktz2*(r13*r13)+r11*(D*nu*r12+D*r11*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r12*(D*nu*r11+D*r12*(-4*(a*a)*nu+4*(a*a)+20*(b*b))/(15*a*b)),ktz2*r13*r23+r11*(D*nu*r22+D*r21*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r12*(D*nu*r21+D*r22*(-4*(a*a)*nu+4*(a*a)+20*(b*b))/(15*a*b)),ktz2*r13*r33+r11*(D*nu*r32+D*r31*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r12*(D*nu*r31+D*r32*(-4*(a*a)*nu+4*(a*a)+20*(b*b))/(15*a*b)),D*r11*r13*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r12*r13*(-4*nu/(5*b)-1/(5*b)+b/(a*a)),D*r11*r23*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r12*r23*(-4*nu/(5*b)-1/(5*b)+b/(a*a)),D*r11*r33*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r12*r33*(-4*nu/(5*b)-1/(5*b)+b/(a*a)),D*(r11*r11)*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*(r12*r12)*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r11*r21*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*r12*r22*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r11*r31*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*r12*r32*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r11*r13*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r12*r13*(-nu/(5*b)+1/(5*b)-b/(a*a)),D*r11*r23*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r12*r23*(-nu/(5*b)+1/(5*b)-b/(a*a)),D*r11*r33*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r12*r33*(-nu/(5*b)+1/(5*b)-b/(a*a)),D*(r11*r11)*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*(r12*r12)*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*r11*r21*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*r12*r22*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*r11*r31*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*r12*r32*((a*a)*(1-nu)+5*(b*b))/(15*a*b),
            D*r13*r21*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r13*r22*(nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r21*r23*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r22*r23*(nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r21*r33*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r22*r33*(nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r11*r21*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*r12*r22*((a*a)*nu-(a*a)+10*(b*b))/(15*a*b),D*(r21*r21)*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*(r22*r22)*((a*a)*nu-(a*a)+10*(b*b))/(15*a*b),D*r21*r31*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*r22*r32*((a*a)*nu-(a*a)+10*(b*b))/(15*a*b),D*r13*r21*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r13*r22*(4*nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r21*r23*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r22*r23*(4*nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r21*r33*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r22*r33*(4*nu/(5*b)+1/(5*b)+2*b/(a*a)),ktz2*r13*r23+r21*(D*nu*r12+D*r11*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r22*(D*nu*r11+D*r12*(-4*(a*a)*nu+4*(a*a)+20*(b*b))/(15*a*b)),ktz2*(r23*r23)+r21*(D*nu*r22+D*r21*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r22*(D*nu*r21+D*r22*(-4*(a*a)*nu+4*(a*a)+20*(b*b))/(15*a*b)),ktz2*r23*r33+r21*(D*nu*r32+D*r31*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r22*(D*nu*r31+D*r32*(-4*(a*a)*nu+4*(a*a)+20*(b*b))/(15*a*b)),D*r13*r21*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r13*r22*(-4*nu/(5*b)-1/(5*b)+b/(a*a)),D*r21*r23*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r22*r23*(-4*nu/(5*b)-1/(5*b)+b/(a*a)),D*r21*r33*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r22*r33*(-4*nu/(5*b)-1/(5*b)+b/(a*a)),D*r11*r21*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*r12*r22*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*(r21*r21)*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*(r22*r22)*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r21*r31*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*r22*r32*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r13*r21*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r13*r22*(-nu/(5*b)+1/(5*b)-b/(a*a)),D*r21*r23*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r22*r23*(-nu/(5*b)+1/(5*b)-b/(a*a)),D*r21*r33*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r22*r33*(-nu/(5*b)+1/(5*b)-b/(a*a)),D*r11*r21*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*r12*r22*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*(r21*r21)*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*(r22*r22)*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*r21*r31*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*r22*r32*((a*a)*(1-nu)+5*(b*b))/(15*a*b),
            D*r13*r31*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r13*r32*(nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r23*r31*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r23*r32*(nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r31*r33*(a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r32*r33*(nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r11*r31*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*r12*r32*((a*a)*nu-(a*a)+10*(b*b))/(15*a*b),D*r21*r31*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*r22*r32*((a*a)*nu-(a*a)+10*(b*b))/(15*a*b),D*(r31*r31)*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*(r32*r32)*((a*a)*nu-(a*a)+10*(b*b))/(15*a*b),D*r13*r31*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r13*r32*(4*nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r23*r31*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r23*r32*(4*nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r31*r33*(2*a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r32*r33*(4*nu/(5*b)+1/(5*b)+2*b/(a*a)),ktz2*r13*r33+r31*(D*nu*r12+D*r11*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r32*(D*nu*r11+D*r12*(-4*(a*a)*nu+4*(a*a)+20*(b*b))/(15*a*b)),ktz2*r23*r33+r31*(D*nu*r22+D*r21*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r32*(D*nu*r21+D*r22*(-4*(a*a)*nu+4*(a*a)+20*(b*b))/(15*a*b)),ktz2*(r33*r33)+r31*(D*nu*r32+D*r31*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r32*(D*nu*r31+D*r32*(-4*(a*a)*nu+4*(a*a)+20*(b*b))/(15*a*b)),D*r13*r31*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r13*r32*(-4*nu/(5*b)-1/(5*b)+b/(a*a)),D*r23*r31*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r23*r32*(-4*nu/(5*b)-1/(5*b)+b/(a*a)),D*r31*r33*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r32*r33*(-4*nu/(5*b)-1/(5*b)+b/(a*a)),D*r11*r31*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*r12*r32*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r21*r31*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*r22*r32*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*(r31*r31)*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*(r32*r32)*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r13*r31*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r13*r32*(-nu/(5*b)+1/(5*b)-b/(a*a)),D*r23*r31*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r23*r32*(-nu/(5*b)+1/(5*b)-b/(a*a)),D*r31*r33*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r32*r33*(-nu/(5*b)+1/(5*b)-b/(a*a)),D*r11*r31*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*r12*r32*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*r21*r31*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*r22*r32*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*(r31*r31)*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*(r32*r32)*((a*a)*(1-nu)+5*(b*b))/(15*a*b),
            D*(r13*r13)*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r11*(B*r12*(-nu/8-1/8)+B*r11*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r12*(B*r11*(-nu/8-1/8)+B*r12*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),D*r13*r23*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r11*(B*r22*(-nu/8-1/8)+B*r21*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r12*(B*r21*(-nu/8-1/8)+B*r22*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),D*r13*r33*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r11*(B*r32*(-nu/8-1/8)+B*r31*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r12*(B*r31*(-nu/8-1/8)+B*r32*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),r13*(D*r11*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r12*(nu/(5*b)-1/(5*b)+b/(a*a))),r13*(D*r21*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r22*(nu/(5*b)-1/(5*b)+b/(a*a))),r13*(D*r31*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r32*(nu/(5*b)-1/(5*b)+b/(a*a))),D*(r13*r13)*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r11*(B*r12*(1/8-3*nu/8)+B*r11*((a*a)*(nu-1)+(b*b))/(6*a*b))+r12*(B*r11*(3*nu/8-1/8)+B*r12*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),D*r13*r23*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r11*(B*r22*(1/8-3*nu/8)+B*r21*((a*a)*(nu-1)+(b*b))/(6*a*b))+r12*(B*r21*(3*nu/8-1/8)+B*r22*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),D*r13*r33*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r11*(B*r32*(1/8-3*nu/8)+B*r31*((a*a)*(nu-1)+(b*b))/(6*a*b))+r12*(B*r31*(3*nu/8-1/8)+B*r32*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),r13*(D*r11*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r12*(-4*nu/(5*b)-1/(5*b)+b/(a*a))),r13*(D*r21*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r22*(-4*nu/(5*b)-1/(5*b)+b/(a*a))),r13*(D*r31*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r32*(-4*nu/(5*b)-1/(5*b)+b/(a*a))),D*(r13*r13)*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r11*(B*r12*(nu/8+1/8)+B*r11*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r12*(B*r11*(nu/8+1/8)+B*r12*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),D*r13*r23*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r11*(B*r22*(nu/8+1/8)+B*r21*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r12*(B*r21*(nu/8+1/8)+B*r22*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),D*r13*r33*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r11*(B*r32*(nu/8+1/8)+B*r31*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r12*(B*r31*(nu/8+1/8)+B*r32*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),r13*(D*r11*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r12*(4*nu/(5*b)+1/(5*b)+2*b/(a*a))),r13*(D*r21*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r22*(4*nu/(5*b)+1/(5*b)+2*b/(a*a))),r13*(D*r31*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r32*(4*nu/(5*b)+1/(5*b)+2*b/(a*a))),D*(r13*r13)*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r11*(B*r12*(3*nu/8-1/8)+B*r11*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r12*(B*r11*(1/8-3*nu/8)+B*r12*((a*a)+(b*b)*(nu-1))/(6*a*b)),D*r13*r23*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r11*(B*r22*(3*nu/8-1/8)+B*r21*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r12*(B*r21*(1/8-3*nu/8)+B*r22*((a*a)+(b*b)*(nu-1))/(6*a*b)),D*r13*r33*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r11*(B*r32*(3*nu/8-1/8)+B*r31*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r12*(B*r31*(1/8-3*nu/8)+B*r32*((a*a)+(b*b)*(nu-1))/(6*a*b)),r13*(D*r11*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r12*(-nu/(5*b)+1/(5*b)+2*b/(a*a))),r13*(D*r21*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r22*(-nu/(5*b)+1/(5*b)+2*b/(a*a))),r13*(D*r31*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r32*(-nu/(5*b)+1/(5*b)+2*b/(a*a))),
            D*r13*r23*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r21*(B*r12*(-nu/8-1/8)+B*r11*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r22*(B*r11*(-nu/8-1/8)+B*r12*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),D*(r23*r23)*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r21*(B*r22*(-nu/8-1/8)+B*r21*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r22*(B*r21*(-nu/8-1/8)+B*r22*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),D*r23*r33*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r21*(B*r32*(-nu/8-1/8)+B*r31*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r22*(B*r31*(-nu/8-1/8)+B*r32*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),r23*(D*r11*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r12*(nu/(5*b)-1/(5*b)+b/(a*a))),r23*(D*r21*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r22*(nu/(5*b)-1/(5*b)+b/(a*a))),r23*(D*r31*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r32*(nu/(5*b)-1/(5*b)+b/(a*a))),D*r13*r23*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r21*(B*r12*(1/8-3*nu/8)+B*r11*((a*a)*(nu-1)+(b*b))/(6*a*b))+r22*(B*r11*(3*nu/8-1/8)+B*r12*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),D*(r23*r23)*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r21*(B*r22*(1/8-3*nu/8)+B*r21*((a*a)*(nu-1)+(b*b))/(6*a*b))+r22*(B*r21*(3*nu/8-1/8)+B*r22*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),D*r23*r33*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r21*(B*r32*(1/8-3*nu/8)+B*r31*((a*a)*(nu-1)+(b*b))/(6*a*b))+r22*(B*r31*(3*nu/8-1/8)+B*r32*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),r23*(D*r11*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r12*(-4*nu/(5*b)-1/(5*b)+b/(a*a))),r23*(D*r21*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r22*(-4*nu/(5*b)-1/(5*b)+b/(a*a))),r23*(D*r31*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r32*(-4*nu/(5*b)-1/(5*b)+b/(a*a))),D*r13*r23*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r21*(B*r12*(nu/8+1/8)+B*r11*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r22*(B*r11*(nu/8+1/8)+B*r12*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),D*(r23*r23)*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r21*(B*r22*(nu/8+1/8)+B*r21*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r22*(B*r21*(nu/8+1/8)+B*r22*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),D*r23*r33*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r21*(B*r32*(nu/8+1/8)+B*r31*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r22*(B*r31*(nu/8+1/8)+B*r32*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),r23*(D*r11*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r12*(4*nu/(5*b)+1/(5*b)+2*b/(a*a))),r23*(D*r21*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r22*(4*nu/(5*b)+1/(5*b)+2*b/(a*a))),r23*(D*r31*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r32*(4*nu/(5*b)+1/(5*b)+2*b/(a*a))),D*r13*r23*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r21*(B*r12*(3*nu/8-1/8)+B*r11*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r22*(B*r11*(1/8-3*nu/8)+B*r12*((a*a)+(b*b)*(nu-1))/(6*a*b)),D*(r23*r23)*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r21*(B*r22*(3*nu/8-1/8)+B*r21*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r22*(B*r21*(1/8-3*nu/8)+B*r22*((a*a)+(b*b)*(nu-1))/(6*a*b)),D*r23*r33*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r21*(B*r32*(3*nu/8-1/8)+B*r31*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r22*(B*r31*(1/8-3*nu/8)+B*r32*((a*a)+(b*b)*(nu-1))/(6*a*b)),r23*(D*r11*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r12*(-nu/(5*b)+1/(5*b)+2*b/(a*a))),r23*(D*r21*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r22*(-nu/(5*b)+1/(5*b)+2*b/(a*a))),r23*(D*r31*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r32*(-nu/(5*b)+1/(5*b)+2*b/(a*a))),
            D*r13*r33*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r31*(B*r12*(-nu/8-1/8)+B*r11*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r32*(B*r11*(-nu/8-1/8)+B*r12*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),D*r23*r33*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r31*(B*r22*(-nu/8-1/8)+B*r21*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r32*(B*r21*(-nu/8-1/8)+B*r22*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),D*(r33*r33)*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r31*(B*r32*(-nu/8-1/8)+B*r31*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r32*(B*r31*(-nu/8-1/8)+B*r32*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),r33*(D*r11*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r12*(nu/(5*b)-1/(5*b)+b/(a*a))),r33*(D*r21*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r22*(nu/(5*b)-1/(5*b)+b/(a*a))),r33*(D*r31*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r32*(nu/(5*b)-1/(5*b)+b/(a*a))),D*r13*r33*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r31*(B*r12*(1/8-3*nu/8)+B*r11*((a*a)*(nu-1)+(b*b))/(6*a*b))+r32*(B*r11*(3*nu/8-1/8)+B*r12*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),D*r23*r33*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r31*(B*r22*(1/8-3*nu/8)+B*r21*((a*a)*(nu-1)+(b*b))/(6*a*b))+r32*(B*r21*(3*nu/8-1/8)+B*r22*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),D*(r33*r33)*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r31*(B*r32*(1/8-3*nu/8)+B*r31*((a*a)*(nu-1)+(b*b))/(6*a*b))+r32*(B*r31*(3*nu/8-1/8)+B*r32*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),r33*(D*r11*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r12*(-4*nu/(5*b)-1/(5*b)+b/(a*a))),r33*(D*r21*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r22*(-4*nu/(5*b)-1/(5*b)+b/(a*a))),r33*(D*r31*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r32*(-4*nu/(5*b)-1/(5*b)+b/(a*a))),D*r13*r33*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r31*(B*r12*(nu/8+1/8)+B*r11*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r32*(B*r11*(nu/8+1/8)+B*r12*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),D*r23*r33*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r31*(B*r22*(nu/8+1/8)+B*r21*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r32*(B*r21*(nu/8+1/8)+B*r22*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),D*(r33*r33)*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r31*(B*r32*(nu/8+1/8)+B*r31*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r32*(B*r31*(nu/8+1/8)+B*r32*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),r33*(D*r11*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r12*(4*nu/(5*b)+1/(5*b)+2*b/(a*a))),r33*(D*r21*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r22*(4*nu/(5*b)+1/(5*b)+2*b/(a*a))),r33*(D*r31*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r32*(4*nu/(5*b)+1/(5*b)+2*b/(a*a))),D*r13*r33*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r31*(B*r12*(3*nu/8-1/8)+B*r11*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r32*(B*r11*(1/8-3*nu/8)+B*r12*((a*a)+(b*b)*(nu-1))/(6*a*b)),D*r23*r33*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r31*(B*r22*(3*nu/8-1/8)+B*r21*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r32*(B*r21*(1/8-3*nu/8)+B*r22*((a*a)+(b*b)*(nu-1))/(6*a*b)),D*(r33*r33)*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r31*(B*r32*(3*nu/8-1/8)+B*r31*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r32*(B*r31*(1/8-3*nu/8)+B*r32*((a*a)+(b*b)*(nu-1))/(6*a*b)),r33*(D*r11*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r12*(-nu/(5*b)+1/(5*b)+2*b/(a*a))),r33*(D*r21*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r22*(-nu/(5*b)+1/(5*b)+2*b/(a*a))),r33*(D*r31*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r32*(-nu/(5*b)+1/(5*b)+2*b/(a*a))),
            D*r11*r13*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r12*r13*(-nu/(5*b)+1/(5*b)-b/(a*a)),D*r11*r23*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r12*r23*(-nu/(5*b)+1/(5*b)-b/(a*a)),D*r11*r33*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r12*r33*(-nu/(5*b)+1/(5*b)-b/(a*a)),D*(r11*r11)*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*(r12*r12)*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*r11*r21*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*r12*r22*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*r11*r31*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*r12*r32*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*r11*r13*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r12*r13*(-4*nu/(5*b)-1/(5*b)+b/(a*a)),D*r11*r23*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r12*r23*(-4*nu/(5*b)-1/(5*b)+b/(a*a)),D*r11*r33*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r12*r33*(-4*nu/(5*b)-1/(5*b)+b/(a*a)),D*(r11*r11)*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*(r12*r12)*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r11*r21*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*r12*r22*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r11*r31*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*r12*r32*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r11*r13*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r12*r13*(4*nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r11*r23*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r12*r23*(4*nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r11*r33*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r12*r33*(4*nu/(5*b)+1/(5*b)+2*b/(a*a)),ktz3*(r13*r13)+r11*(-D*nu*r12+D*r11*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r12*(-D*nu*r11+D*r12*(4*(a*a)*(1-nu)+20*(b*b))/(15*a*b)),ktz3*r13*r23+r11*(-D*nu*r22+D*r21*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r12*(-D*nu*r21+D*r22*(4*(a*a)*(1-nu)+20*(b*b))/(15*a*b)),ktz3*r13*r33+r11*(-D*nu*r32+D*r31*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r12*(-D*nu*r31+D*r32*(4*(a*a)*(1-nu)+20*(b*b))/(15*a*b)),D*r11*r13*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r12*r13*(nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r11*r23*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r12*r23*(nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r11*r33*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r12*r33*(nu/(5*b)-1/(5*b)-2*b/(a*a)),D*(r11*r11)*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*(r12*r12)*((a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r11*r21*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*r12*r22*((a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r11*r31*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*r12*r32*((a*a)*(nu-1)+10*(b*b))/(15*a*b),
            D*r13*r21*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r13*r22*(-nu/(5*b)+1/(5*b)-b/(a*a)),D*r21*r23*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r22*r23*(-nu/(5*b)+1/(5*b)-b/(a*a)),D*r21*r33*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r22*r33*(-nu/(5*b)+1/(5*b)-b/(a*a)),D*r11*r21*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*r12*r22*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*(r21*r21)*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*(r22*r22)*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*r21*r31*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*r22*r32*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*r13*r21*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r13*r22*(-4*nu/(5*b)-1/(5*b)+b/(a*a)),D*r21*r23*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r22*r23*(-4*nu/(5*b)-1/(5*b)+b/(a*a)),D*r21*r33*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r22*r33*(-4*nu/(5*b)-1/(5*b)+b/(a*a)),D*r11*r21*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*r12*r22*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*(r21*r21)*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*(r22*r22)*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r21*r31*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*r22*r32*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r13*r21*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r13*r22*(4*nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r21*r23*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r22*r23*(4*nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r21*r33*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r22*r33*(4*nu/(5*b)+1/(5*b)+2*b/(a*a)),ktz3*r13*r23+r21*(-D*nu*r12+D*r11*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r22*(-D*nu*r11+D*r12*(4*(a*a)*(1-nu)+20*(b*b))/(15*a*b)),ktz3*(r23*r23)+r21*(-D*nu*r22+D*r21*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r22*(-D*nu*r21+D*r22*(4*(a*a)*(1-nu)+20*(b*b))/(15*a*b)),ktz3*r23*r33+r21*(-D*nu*r32+D*r31*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r22*(-D*nu*r31+D*r32*(4*(a*a)*(1-nu)+20*(b*b))/(15*a*b)),D*r13*r21*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r13*r22*(nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r21*r23*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r22*r23*(nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r21*r33*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r22*r33*(nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r11*r21*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*r12*r22*((a*a)*(nu-1)+10*(b*b))/(15*a*b),D*(r21*r21)*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*(r22*r22)*((a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r21*r31*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*r22*r32*((a*a)*(nu-1)+10*(b*b))/(15*a*b),
            D*r13*r31*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r13*r32*(-nu/(5*b)+1/(5*b)-b/(a*a)),D*r23*r31*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r23*r32*(-nu/(5*b)+1/(5*b)-b/(a*a)),D*r31*r33*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r32*r33*(-nu/(5*b)+1/(5*b)-b/(a*a)),D*r11*r31*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*r12*r32*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*r21*r31*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*r22*r32*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*(r31*r31)*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*(r32*r32)*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*r13*r31*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r13*r32*(-4*nu/(5*b)-1/(5*b)+b/(a*a)),D*r23*r31*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r23*r32*(-4*nu/(5*b)-1/(5*b)+b/(a*a)),D*r31*r33*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r32*r33*(-4*nu/(5*b)-1/(5*b)+b/(a*a)),D*r11*r31*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*r12*r32*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r21*r31*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*r22*r32*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*(r31*r31)*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*(r32*r32)*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r13*r31*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r13*r32*(4*nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r23*r31*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r23*r32*(4*nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r31*r33*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r32*r33*(4*nu/(5*b)+1/(5*b)+2*b/(a*a)),ktz3*r13*r33+r31*(-D*nu*r12+D*r11*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r32*(-D*nu*r11+D*r12*(4*(a*a)*(1-nu)+20*(b*b))/(15*a*b)),ktz3*r23*r33+r31*(-D*nu*r22+D*r21*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r32*(-D*nu*r21+D*r22*(4*(a*a)*(1-nu)+20*(b*b))/(15*a*b)),ktz3*(r33*r33)+r31*(-D*nu*r32+D*r31*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r32*(-D*nu*r31+D*r32*(4*(a*a)*(1-nu)+20*(b*b))/(15*a*b)),D*r13*r31*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r13*r32*(nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r23*r31*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r23*r32*(nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r31*r33*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r32*r33*(nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r11*r31*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*r12*r32*((a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r21*r31*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*r22*r32*((a*a)*(nu-1)+10*(b*b))/(15*a*b),D*(r31*r31)*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*(r32*r32)*((a*a)*(nu-1)+10*(b*b))/(15*a*b),
            D*(r13*r13)*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r11*(B*r12*(3*nu/8-1/8)+B*r11*((a*a)*(nu-1)+(b*b))/(6*a*b))+r12*(B*r11*(1/8-3*nu/8)+B*r12*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),D*r13*r23*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r11*(B*r22*(3*nu/8-1/8)+B*r21*((a*a)*(nu-1)+(b*b))/(6*a*b))+r12*(B*r21*(1/8-3*nu/8)+B*r22*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),D*r13*r33*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r11*(B*r32*(3*nu/8-1/8)+B*r31*((a*a)*(nu-1)+(b*b))/(6*a*b))+r12*(B*r31*(1/8-3*nu/8)+B*r32*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),r13*(D*r11*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r12*(4*nu/(5*b)+1/(5*b)-b/(a*a))),r13*(D*r21*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r22*(4*nu/(5*b)+1/(5*b)-b/(a*a))),r13*(D*r31*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r32*(4*nu/(5*b)+1/(5*b)-b/(a*a))),D*(r13*r13)*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r11*(B*r12*(nu/8+1/8)+B*r11*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r12*(B*r11*(nu/8+1/8)+B*r12*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),D*r13*r23*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r11*(B*r22*(nu/8+1/8)+B*r21*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r12*(B*r21*(nu/8+1/8)+B*r22*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),D*r13*r33*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r11*(B*r32*(nu/8+1/8)+B*r31*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r12*(B*r31*(nu/8+1/8)+B*r32*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),r13*(D*r11*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r12*(-nu/(5*b)+1/(5*b)-b/(a*a))),r13*(D*r21*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r22*(-nu/(5*b)+1/(5*b)-b/(a*a))),r13*(D*r31*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r32*(-nu/(5*b)+1/(5*b)-b/(a*a))),D*(r13*r13)*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r11*(B*r12*(1/8-3*nu/8)+B*r11*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r12*(B*r11*(3*nu/8-1/8)+B*r12*((a*a)+(b*b)*(nu-1))/(6*a*b)),D*r13*r23*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r11*(B*r22*(1/8-3*nu/8)+B*r21*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r12*(B*r21*(3*nu/8-1/8)+B*r22*((a*a)+(b*b)*(nu-1))/(6*a*b)),D*r13*r33*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r11*(B*r32*(1/8-3*nu/8)+B*r31*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r12*(B*r31*(3*nu/8-1/8)+B*r32*((a*a)+(b*b)*(nu-1))/(6*a*b)),r13*(D*r11*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r12*(nu/(5*b)-1/(5*b)-2*b/(a*a))),r13*(D*r21*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r22*(nu/(5*b)-1/(5*b)-2*b/(a*a))),r13*(D*r31*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r32*(nu/(5*b)-1/(5*b)-2*b/(a*a))),D*(r13*r13)*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r11*(B*r12*(-nu/8-1/8)+B*r11*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r12*(B*r11*(-nu/8-1/8)+B*r12*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),D*r13*r23*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r11*(B*r22*(-nu/8-1/8)+B*r21*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r12*(B*r21*(-nu/8-1/8)+B*r22*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),D*r13*r33*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r11*(B*r32*(-nu/8-1/8)+B*r31*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r12*(B*r31*(-nu/8-1/8)+B*r32*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),r13*(D*r11*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r12*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a))),r13*(D*r21*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r22*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a))),r13*(D*r31*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r32*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a))),
            D*r13*r23*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r21*(B*r12*(3*nu/8-1/8)+B*r11*((a*a)*(nu-1)+(b*b))/(6*a*b))+r22*(B*r11*(1/8-3*nu/8)+B*r12*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),D*(r23*r23)*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r21*(B*r22*(3*nu/8-1/8)+B*r21*((a*a)*(nu-1)+(b*b))/(6*a*b))+r22*(B*r21*(1/8-3*nu/8)+B*r22*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),D*r23*r33*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r21*(B*r32*(3*nu/8-1/8)+B*r31*((a*a)*(nu-1)+(b*b))/(6*a*b))+r22*(B*r31*(1/8-3*nu/8)+B*r32*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),r23*(D*r11*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r12*(4*nu/(5*b)+1/(5*b)-b/(a*a))),r23*(D*r21*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r22*(4*nu/(5*b)+1/(5*b)-b/(a*a))),r23*(D*r31*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r32*(4*nu/(5*b)+1/(5*b)-b/(a*a))),D*r13*r23*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r21*(B*r12*(nu/8+1/8)+B*r11*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r22*(B*r11*(nu/8+1/8)+B*r12*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),D*(r23*r23)*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r21*(B*r22*(nu/8+1/8)+B*r21*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r22*(B*r21*(nu/8+1/8)+B*r22*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),D*r23*r33*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r21*(B*r32*(nu/8+1/8)+B*r31*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r22*(B*r31*(nu/8+1/8)+B*r32*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),r23*(D*r11*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r12*(-nu/(5*b)+1/(5*b)-b/(a*a))),r23*(D*r21*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r22*(-nu/(5*b)+1/(5*b)-b/(a*a))),r23*(D*r31*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r32*(-nu/(5*b)+1/(5*b)-b/(a*a))),D*r13*r23*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r21*(B*r12*(1/8-3*nu/8)+B*r11*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r22*(B*r11*(3*nu/8-1/8)+B*r12*((a*a)+(b*b)*(nu-1))/(6*a*b)),D*(r23*r23)*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r21*(B*r22*(1/8-3*nu/8)+B*r21*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r22*(B*r21*(3*nu/8-1/8)+B*r22*((a*a)+(b*b)*(nu-1))/(6*a*b)),D*r23*r33*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r21*(B*r32*(1/8-3*nu/8)+B*r31*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r22*(B*r31*(3*nu/8-1/8)+B*r32*((a*a)+(b*b)*(nu-1))/(6*a*b)),r23*(D*r11*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r12*(nu/(5*b)-1/(5*b)-2*b/(a*a))),r23*(D*r21*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r22*(nu/(5*b)-1/(5*b)-2*b/(a*a))),r23*(D*r31*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r32*(nu/(5*b)-1/(5*b)-2*b/(a*a))),D*r13*r23*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r21*(B*r12*(-nu/8-1/8)+B*r11*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r22*(B*r11*(-nu/8-1/8)+B*r12*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),D*(r23*r23)*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r21*(B*r22*(-nu/8-1/8)+B*r21*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r22*(B*r21*(-nu/8-1/8)+B*r22*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),D*r23*r33*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r21*(B*r32*(-nu/8-1/8)+B*r31*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r22*(B*r31*(-nu/8-1/8)+B*r32*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),r23*(D*r11*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r12*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a))),r23*(D*r21*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r22*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a))),r23*(D*r31*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r32*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a))),
            D*r13*r33*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r31*(B*r12*(3*nu/8-1/8)+B*r11*((a*a)*(nu-1)+(b*b))/(6*a*b))+r32*(B*r11*(1/8-3*nu/8)+B*r12*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),D*r23*r33*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r31*(B*r22*(3*nu/8-1/8)+B*r21*((a*a)*(nu-1)+(b*b))/(6*a*b))+r32*(B*r21*(1/8-3*nu/8)+B*r22*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),D*(r33*r33)*(-4*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)+2*b/(a*a*a))+r31*(B*r32*(3*nu/8-1/8)+B*r31*((a*a)*(nu-1)+(b*b))/(6*a*b))+r32*(B*r31*(1/8-3*nu/8)+B*r32*(-4*(a*a)+(b*b)*(1-nu))/(12*a*b)),r33*(D*r11*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r12*(4*nu/(5*b)+1/(5*b)-b/(a*a))),r33*(D*r21*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r22*(4*nu/(5*b)+1/(5*b)-b/(a*a))),r33*(D*r31*(-2*a/(b*b)+nu/(5*a)-1/(5*a))+D*r32*(4*nu/(5*b)+1/(5*b)-b/(a*a))),D*r13*r33*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r31*(B*r12*(nu/8+1/8)+B*r11*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r32*(B*r11*(nu/8+1/8)+B*r12*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),D*r23*r33*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r31*(B*r22*(nu/8+1/8)+B*r21*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r32*(B*r21*(nu/8+1/8)+B*r22*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),D*(r33*r33)*(-2*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)-2*b/(a*a*a))+r31*(B*r32*(nu/8+1/8)+B*r31*((a*a)*(nu-1)-2*(b*b))/(12*a*b))+r32*(B*r31*(nu/8+1/8)+B*r32*(-2*(a*a)+(b*b)*(nu-1))/(12*a*b)),r33*(D*r11*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r12*(-nu/(5*b)+1/(5*b)-b/(a*a))),r33*(D*r21*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r22*(-nu/(5*b)+1/(5*b)-b/(a*a))),r33*(D*r31*(-a/(b*b)-nu/(5*a)+1/(5*a))+D*r32*(-nu/(5*b)+1/(5*b)-b/(a*a))),D*r13*r33*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r31*(B*r12*(1/8-3*nu/8)+B*r11*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r32*(B*r11*(3*nu/8-1/8)+B*r12*((a*a)+(b*b)*(nu-1))/(6*a*b)),D*r23*r33*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r31*(B*r22*(1/8-3*nu/8)+B*r21*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r32*(B*r21*(3*nu/8-1/8)+B*r22*((a*a)+(b*b)*(nu-1))/(6*a*b)),D*(r33*r33)*(2*a/(b*b*b)+4*nu/(5*a*b)-14/(5*a*b)-4*b/(a*a*a))+r31*(B*r32*(1/8-3*nu/8)+B*r31*((a*a)*(1-nu)-4*(b*b))/(12*a*b))+r32*(B*r31*(3*nu/8-1/8)+B*r32*((a*a)+(b*b)*(nu-1))/(6*a*b)),r33*(D*r11*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r12*(nu/(5*b)-1/(5*b)-2*b/(a*a))),r33*(D*r21*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r22*(nu/(5*b)-1/(5*b)-2*b/(a*a))),r33*(D*r31*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r32*(nu/(5*b)-1/(5*b)-2*b/(a*a))),D*r13*r33*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r31*(B*r12*(-nu/8-1/8)+B*r11*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r32*(B*r11*(-nu/8-1/8)+B*r12*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),D*r23*r33*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r31*(B*r22*(-nu/8-1/8)+B*r21*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r32*(B*r21*(-nu/8-1/8)+B*r22*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),D*(r33*r33)*(4*a/(b*b*b)-4*nu/(5*a*b)+14/(5*a*b)+4*b/(a*a*a))+r31*(B*r32*(-nu/8-1/8)+B*r31*((a*a)*(1-nu)+2*(b*b))/(6*a*b))+r32*(B*r31*(-nu/8-1/8)+B*r32*(2*(a*a)+(b*b)*(1-nu))/(6*a*b)),r33*(D*r11*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r12*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a))),r33*(D*r21*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r22*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a))),r33*(D*r31*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r32*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a))),
            D*r11*r13*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r12*r13*(4*nu/(5*b)+1/(5*b)-b/(a*a)),D*r11*r23*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r12*r23*(4*nu/(5*b)+1/(5*b)-b/(a*a)),D*r11*r33*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r12*r33*(4*nu/(5*b)+1/(5*b)-b/(a*a)),D*(r11*r11)*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*(r12*r12)*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r11*r21*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*r12*r22*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r11*r31*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*r12*r32*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r11*r13*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r12*r13*(nu/(5*b)-1/(5*b)+b/(a*a)),D*r11*r23*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r12*r23*(nu/(5*b)-1/(5*b)+b/(a*a)),D*r11*r33*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r12*r33*(nu/(5*b)-1/(5*b)+b/(a*a)),D*(r11*r11)*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*(r12*r12)*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*r11*r21*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*r12*r22*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*r11*r31*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*r12*r32*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*r11*r13*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r12*r13*(-nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r11*r23*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r12*r23*(-nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r11*r33*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r12*r33*(-nu/(5*b)+1/(5*b)+2*b/(a*a)),D*(r11*r11)*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*(r12*r12)*((a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r11*r21*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*r12*r22*((a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r11*r31*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*r12*r32*((a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r11*r13*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r12*r13*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r11*r23*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r12*r23*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r11*r33*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r12*r33*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a)),ktz4*(r13*r13)+r11*(D*nu*r12+D*r11*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r12*(D*nu*r11+D*r12*(4*(a*a)*(1-nu)+20*(b*b))/(15*a*b)),ktz4*r13*r23+r11*(D*nu*r22+D*r21*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r12*(D*nu*r21+D*r22*(4*(a*a)*(1-nu)+20*(b*b))/(15*a*b)),ktz4*r13*r33+r11*(D*nu*r32+D*r31*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r12*(D*nu*r31+D*r32*(4*(a*a)*(1-nu)+20*(b*b))/(15*a*b)),
            D*r13*r21*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r13*r22*(4*nu/(5*b)+1/(5*b)-b/(a*a)),D*r21*r23*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r22*r23*(4*nu/(5*b)+1/(5*b)-b/(a*a)),D*r21*r33*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r22*r33*(4*nu/(5*b)+1/(5*b)-b/(a*a)),D*r11*r21*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*r12*r22*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*(r21*r21)*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*(r22*r22)*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r21*r31*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*r22*r32*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r13*r21*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r13*r22*(nu/(5*b)-1/(5*b)+b/(a*a)),D*r21*r23*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r22*r23*(nu/(5*b)-1/(5*b)+b/(a*a)),D*r21*r33*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r22*r33*(nu/(5*b)-1/(5*b)+b/(a*a)),D*r11*r21*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*r12*r22*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*(r21*r21)*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*(r22*r22)*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*r21*r31*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*r22*r32*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*r13*r21*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r13*r22*(-nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r21*r23*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r22*r23*(-nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r21*r33*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r22*r33*(-nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r11*r21*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*r12*r22*((a*a)*(nu-1)+10*(b*b))/(15*a*b),D*(r21*r21)*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*(r22*r22)*((a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r21*r31*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*r22*r32*((a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r13*r21*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r13*r22*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r21*r23*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r22*r23*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r21*r33*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r22*r33*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a)),ktz4*r13*r23+r21*(D*nu*r12+D*r11*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r22*(D*nu*r11+D*r12*(4*(a*a)*(1-nu)+20*(b*b))/(15*a*b)),ktz4*(r23*r23)+r21*(D*nu*r22+D*r21*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r22*(D*nu*r21+D*r22*(4*(a*a)*(1-nu)+20*(b*b))/(15*a*b)),ktz4*r23*r33+r21*(D*nu*r32+D*r31*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r22*(D*nu*r31+D*r32*(4*(a*a)*(1-nu)+20*(b*b))/(15*a*b)),
            D*r13*r31*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r13*r32*(4*nu/(5*b)+1/(5*b)-b/(a*a)),D*r23*r31*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r23*r32*(4*nu/(5*b)+1/(5*b)-b/(a*a)),D*r31*r33*(2*a/(b*b)-nu/(5*a)+1/(5*a))+D*r32*r33*(4*nu/(5*b)+1/(5*b)-b/(a*a)),D*r11*r31*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*r12*r32*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r21*r31*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*r22*r32*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*(r31*r31)*(10*(a*a)+(b*b)*nu-(b*b))/(15*a*b)+D*(r32*r32)*(4*(a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r13*r31*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r13*r32*(nu/(5*b)-1/(5*b)+b/(a*a)),D*r23*r31*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r23*r32*(nu/(5*b)-1/(5*b)+b/(a*a)),D*r31*r33*(a/(b*b)+nu/(5*a)-1/(5*a))+D*r32*r33*(nu/(5*b)-1/(5*b)+b/(a*a)),D*r11*r31*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*r12*r32*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*r21*r31*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*r22*r32*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*(r31*r31)*(5*(a*a)+(b*b)*(1-nu))/(15*a*b)+D*(r32*r32)*((a*a)*(1-nu)+5*(b*b))/(15*a*b),D*r13*r31*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r13*r32*(-nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r23*r31*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r23*r32*(-nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r31*r33*(-a/(b*b)+4*nu/(5*a)+1/(5*a))+D*r32*r33*(-nu/(5*b)+1/(5*b)+2*b/(a*a)),D*r11*r31*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*r12*r32*((a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r21*r31*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*r22*r32*((a*a)*(nu-1)+10*(b*b))/(15*a*b),D*(r31*r31)*(10*(a*a)+4*(b*b)*nu-4*(b*b))/(15*a*b)+D*(r32*r32)*((a*a)*(nu-1)+10*(b*b))/(15*a*b),D*r13*r31*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r13*r32*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r23*r31*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r23*r32*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a)),D*r31*r33*(-2*a/(b*b)-4*nu/(5*a)-1/(5*a))+D*r32*r33*(-4*nu/(5*b)-1/(5*b)-2*b/(a*a)),ktz4*r13*r33+r31*(D*nu*r12+D*r11*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r32*(D*nu*r11+D*r12*(4*(a*a)*(1-nu)+20*(b*b))/(15*a*b)),ktz4*r23*r33+r31*(D*nu*r22+D*r21*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r32*(D*nu*r21+D*r22*(4*(a*a)*(1-nu)+20*(b*b))/(15*a*b)),ktz4*(r33*r33)+r31*(D*nu*r32+D*r31*(20*(a*a)-4*(b*b)*nu+4*(b*b))/(15*a*b))+r32*(D*nu*r31+D*r32*(4*(a*a)*(1-nu)+20*(b*b))/(15*a*b));


    
    for (int i=0; i<24; i++){
        for (int j=0; j<=i; j++){
            double mij = m24_2(i,j);
            if ((mij>1e-3) || (mij<-1e-3)){
                int i_loc = i/6;
                int j_loc = j/6;
                int no_i, no_j;
                switch(i_loc) {
                    case 0: no_i = element.pt1.no; break;
                    case 1: no_i = element.pt2.no; break;
                    case 2: no_i = element.pt3.no; break;
                    case 3: no_i = element.pt4.no; break;
                };
                switch(j_loc) {
                    case 0: no_j = element.pt1.no; break;
                    case 1: no_j = element.pt2.no; break;
                    case 2: no_j = element.pt3.no; break;
                    case 3: no_j = element.pt4.no; break;
                };
                lst.push_back(T(6*no_i+i%6,6*no_j+j%6,mij));
                if (j<i){
                    lst.push_back(T(6*no_j+j%6,6*no_i+i%6,mij));
                };
                //cout << 6*no_i+i%6 << "," << 6*no_j+j%6 << "," << mij << endl;
            };
        };
    };
};

// Cette fonction prend en entrée un élément et la force surfacique normale exercée sur celui-ci
// Elle complète la liste de triplets pour le vecteur-force.
void global_load_elem(vector<T> &lst, face element, double gz){
    double a = element.a;
    double b = element.b;
    VectorXd F_loc(24);
    F_loc << 0,0,1,b/6.,-a/6.,0,0,0,1,b/6.,a/6.,0,0,0,1,-b/6.,a/6.,0,0,0,1,-b/6.,-a/6.,0;
    F_loc = a*b/4*gz*F_loc;
    m3_1 = element.local2global();
    m24_1 <<m3_1, z3, z3, z3, z3, z3, z3, z3,
            z3, m3_1, z3, z3, z3, z3, z3, z3,
            z3, z3, m3_1, z3, z3, z3, z3, z3,
            z3, z3, z3, m3_1, z3, z3, z3, z3,
            z3, z3, z3, z3, m3_1, z3, z3, z3,
            z3, z3, z3, z3, z3, m3_1, z3, z3,
            z3, z3, z3, z3, z3, z3, m3_1, z3,
            z3, z3, z3, z3, z3, z3, z3, m3_1;
    VectorXd F_glo(24);
    F_glo = m24_1*F_loc;
    
    for (int i=0; i<24; i++){
        double fi = F_glo(i);
        if ((fi>1e-3) || (fi<-1e-3)){
            int i_loc = i/6;
            int no_i;
            switch(i_loc) {
                case 0: no_i = element.pt1.no; break;
                case 1: no_i = element.pt2.no; break;
                case 2: no_i = element.pt3.no; break;
                case 3: no_i = element.pt4.no; break;
            };
            lst.push_back(T(6*no_i+i%6,0,fi));
        };
    };
};

// IV - Création de la fonction de maillage
// ----------------------------------------

class carac_mail{
    public:
    int Nv, SNi;
    carac_mail(int Nv_in, int SNi_in){
        Nv = Nv_in;
        SNi = SNi_in;
    };
};

carac_mail mailleur(double lh, double lv, double zInf, double zSup, vector<point> &lst, vector<face> &lst_f, vector<point> lst_coins, int nb_coins){
    int compteur = 0;
    int SNi=0;
    double H = zSup-zInf;
    int Nv = H/lv+1;

    for (int i=0; i<nb_coins;i++){
        int Ni = int((lst_coins[i].vectorTo(lst_coins[i+1])).norm()/lh)+1;
        SNi += Ni;
        for (int k=0; k<Ni; k++){
            double taux = double(k)/double(Ni);
            int ktz=1;
            if (k==0){
                ktz = 0;
            };
            lst.push_back(lst_coins[i].interpolTo(lst_coins[i+1],taux,compteur,ktz));
            compteur++;
        };
    };

    lst.reserve((Nv+1)*SNi);

    for (int k=1; k<Nv+1; k++){
        for (int j=0; j<SNi; j++){
            point pt_ori = lst[j];
            lst.push_back(point(pt_ori.x,pt_ori.y,pt_ori.z+H/double(Nv)*k,compteur,pt_ori.ktz));
            compteur += 1;
        };
    };

    for (int k=0; k<Nv; k++){
        for (int l=0; l<SNi; l++){
            if (l<SNi-1){
                lst_f.push_back(face(lst[k*SNi+l],lst[k*SNi+l+1],lst[(k+1)*SNi+l+1],lst[(k+1)*SNi+l]));
            };
            if (l==SNi-1) {
                lst_f.push_back(face(lst[k*SNi+l],lst[k*SNi],lst[(k+1)*SNi],lst[(k+1)*SNi+l]));
            };
        };
    };
    return carac_mail(Nv, SNi);
};

VectorXd renvoie_mX2(double x, double y, double a, double b, double nu){
    VectorXd mX2(12);
    mX2 << 6*(-(a*a*a)*b + 2*(a*a*a)*y + (a*a)*b*x - 2*(a*a)*x*y - (b*b)*nu*(a*b - a*y - 2*b*x + 2*x*y))/((a*a*a)*(b*b*b)), 2*(-2*a*b + 3*a*y + 2*b*x - 3*x*y)/(a*(b*b)), 2*nu*(2*a*b - 2*a*y - 3*b*x + 3*x*y)/((a*a)*b), 6*(-(a*a)*b*x + 2*(a*a)*x*y + (b*b)*nu*(a*b - a*y - 2*b*x + 2*x*y))/((a*a*a)*(b*b*b)), 2*x*(-2*b + 3*y)/(a*(b*b)), 2*nu*(a*b - a*y - 3*b*x + 3*x*y)/((a*a)*b), 6*((a*a)*b*x - 2*(a*a)*x*y + (b*b)*nu*y*(a - 2*x))/((a*a*a)*(b*b*b)), 2*x*(-b + 3*y)/(a*(b*b)), 2*nu*y*(a - 3*x)/((a*a)*b), 6*((a*a*a)*b - 2*(a*a*a)*y - (a*a)*b*x + 2*(a*a)*x*y - (b*b)*nu*y*(a - 2*x))/((a*a*a)*(b*b*b)), 2*(-a*b + 3*a*y + b*x - 3*x*y)/(a*(b*b)), 2*nu*y*(2*a - 3*x)/((a*a)*b);
    return mX2;
};
VectorXd renvoie_mY2(double x, double y, double a, double b, double nu){
    VectorXd mY2(12);
    mY2 << 6*(-(a*a)*nu*(a*b - 2*a*y - b*x + 2*x*y) - a*(b*b*b) + a*(b*b)*y + 2*(b*b*b)*x - 2*(b*b)*x*y)/((a*a*a)*(b*b*b)), 2*nu*(-2*a*b + 3*a*y + 2*b*x - 3*x*y)/(a*(b*b)), 2*(2*a*b - 2*a*y - 3*b*x + 3*x*y)/((a*a)*b), 6*(-(a*a)*nu*x*(b - 2*y) + a*(b*b*b) - a*(b*b)*y - 2*(b*b*b)*x + 2*(b*b)*x*y)/((a*a*a)*(b*b*b)), 2*nu*x*(-2*b + 3*y)/(a*(b*b)), 2*(a*b - a*y - 3*b*x + 3*x*y)/((a*a)*b), 6*((a*a)*nu*x*(b - 2*y) + a*(b*b)*y - 2*(b*b)*x*y)/((a*a*a)*(b*b*b)), 2*nu*x*(-b + 3*y)/(a*(b*b)), 2*y*(a - 3*x)/((a*a)*b), 6*((a*a)*nu*(a*b - 2*a*y - b*x + 2*x*y) - a*(b*b)*y + 2*(b*b)*x*y)/((a*a*a)*(b*b*b)), 2*nu*(-a*b + 3*a*y + b*x - 3*x*y)/(a*(b*b)), 2*y*(2*a - 3*x)/((a*a)*b);
    return mY2;
};
VectorXd renvoie_mXY(double x, double y, double a, double b, double nu){
    VectorXd mXY(12);
    mXY << -1/(a*b) + 6*y/(a*(b*b)) - 6*(y*y)/(a*(b*b*b)) + 6*x/((a*a)*b) - 6*(x*x)/((a*a*a)*b), (-(b*b) + 4*b*y - 3*(y*y))/(a*(b*b)), ((a*a) - 4*a*x + 3*(x*x))/((a*a)*b), 1/(a*b) - 6*y/(a*(b*b)) + 6*(y*y)/(a*(b*b*b)) - 6*x/((a*a)*b) + 6*(x*x)/((a*a*a)*b), ((b*b) - 4*b*y + 3*(y*y))/(a*(b*b)), x*(-2*a + 3*x)/((a*a)*b), -1/(a*b) + 6*y/(a*(b*b)) - 6*(y*y)/(a*(b*b*b)) + 6*x/((a*a)*b) - 6*(x*x)/((a*a*a)*b), y*(-2*b + 3*y)/(a*(b*b)), x*(2*a - 3*x)/((a*a)*b), 1/(a*b) - 6*y/(a*(b*b)) + 6*(y*y)/(a*(b*b*b)) - 6*x/((a*a)*b) + 6*(x*x)/((a*a*a)*b), y*(2*b - 3*y)/(a*(b*b)), (-(a*a) + 4*a*x - 3*(x*x))/((a*a)*b);
    return mXY;
};

// V - Création de la fonction de traitement total
// -----------------------------------------------

void batardeau(double lh, double lv, double zInf, double zSup, vector<point> lst_coins, int nb_coins, double E, double nu, double t){

    auto heure_0 = high_resolution_clock::now();

    vector<T> triplet_K;
    vector<T> triplet_F;
    vector<point> vertices;
    vector<face> elements; 

    carac_mail kar = mailleur(lh, lv, zInf, zSup, vertices, elements, lst_coins, nb_coins);

    auto heure_1 = high_resolution_clock::now();

    int Nv=kar.Nv; int SNi=kar.SNi;
    int nb_total = SNi*(Nv+1);
    int nb_elmt = SNi*Nv;
    cout << "Nombre de nodes : " << nb_total << endl;

    triplet_K.reserve(36*4*nb_total+6*SNi);
    triplet_F.reserve(6*4*nb_total);

    auto heure_2 = high_resolution_clock::now();

    for (int k=0; k<nb_elmt; k++){
        global_stiffness_elem(triplet_K,elements[k],E,nu,t);
        global_load_elem(triplet_F,elements[k],10e3*(zSup-0.5*(elements[k].pt1.z+elements[k].pt4.z)));
    };

    auto heure_3 = high_resolution_clock::now();

    double maxK = 1e20;
    for (int k=0; k<6*SNi; k++){
        triplet_K.push_back(T(k,k,maxK));
    };

    auto heure_4 = high_resolution_clock::now();

    SparseMatrix<double> mat_K(6*nb_total,6*nb_total);
    mat_K.setFromTriplets(triplet_K.begin(),triplet_K.end());

    auto heure_5 = high_resolution_clock::now();

    SparseMatrix<double> mat_F(6*nb_total,1);
    mat_F.setFromTriplets(triplet_F.begin(),triplet_F.end());

    auto heure_6 = high_resolution_clock::now();

    SimplicialCholesky<SparseMatrix<double>> chol(mat_K);

    auto heure_7 = high_resolution_clock::now();

    VectorXd q_sol = chol.solve(mat_F);

    auto heure_8 = high_resolution_clock::now();

    ofstream MyFile("output_batardeau.csv");

    MyFile << "x,y,z,ux,uy,uz,θx,θy,θz" <<endl;
    point stockp;
    for (int k=0; k<nb_total; k++){
        stockp = vertices[k];
        MyFile << stockp.x << "," << stockp.y << "," << stockp.z << "," << q_sol(6*k) << "," << q_sol(6*k+1) << "," << q_sol(6*k+2) << "," << q_sol(6*k+3) << "," << q_sol(6*k+4) << "," << q_sol(6*k+5) << endl;
    };

    MyFile.close();

    auto heure_9 = high_resolution_clock::now();

    ofstream MyFile2("output_batardeau_eff.csv");

    MyFile2 << "x,y,z,mhh,mvv,mhv" <<endl;

    double D=E*t*t*t/(12.0*(1-nu*nu));

    for (int k=0; k<nb_elmt; k++){
        face element = elements[k];

        double a = element.a;
        double b = element.b;
        VectorXd q_global(24);
        q_global << q_sol(seq(6*element.pt1.no,6*element.pt1.no+5)),q_sol(seq(6*element.pt2.no,6*element.pt2.no+5)),
                    q_sol(seq(6*element.pt3.no,6*element.pt3.no+5)),q_sol(seq(6*element.pt4.no,6*element.pt4.no+5));
        m3_1 = element.local2global();
        m24_1 <<m3_1, z3, z3, z3, z3, z3, z3, z3,
                z3, m3_1, z3, z3, z3, z3, z3, z3,
                z3, z3, m3_1, z3, z3, z3, z3, z3,
                z3, z3, z3, m3_1, z3, z3, z3, z3,
                z3, z3, z3, z3, m3_1, z3, z3, z3,
                z3, z3, z3, z3, z3, m3_1, z3, z3,
                z3, z3, z3, z3, z3, z3, m3_1, z3,
                z3, z3, z3, z3, z3, z3, z3, m3_1;
        
        VectorXd q_local_full(24);
        q_local_full = m24_1.transpose()*q_global;
        VectorXd q_local(12);
        q_local << q_local_full(seq(2,4)),q_local_full(seq(8,10)),q_local_full(seq(14,16)),q_local_full(seq(20,22));

        MyFile2 << element.ptC.x << "," << element.ptC.y << "," << element.ptC.z << "," << D*(renvoie_mX2(a/2.,b/2.,a,b,nu).transpose()*q_local) << "," << D*(renvoie_mY2(a/2.,b/2.,a,b,nu).transpose()*q_local) << "," << D*(1-nu)*(renvoie_mXY(a/2.,b/2.,a,b,nu).transpose()*q_local) << endl;
        

    };

    MyFile2.close();

    auto heure_10 = high_resolution_clock::now();

    cout << "Vect+mailleur: " << (duration_cast<microseconds>(heure_1 - heure_0)).count()/1e6 << "s" << endl;
    cout << "Reserv+cout:   " << (duration_cast<microseconds>(heure_2 - heure_1)).count()/1e6 << "s" << endl;
    cout << "Rempl. tripl.: " << (duration_cast<microseconds>(heure_3 - heure_2)).count()/1e6 << "s" << endl;
    cout << "Ajout appuis:  " << (duration_cast<microseconds>(heure_4 - heure_3)).count()/1e6 << "s" << endl;
    cout << "Sparse K:      " << (duration_cast<microseconds>(heure_5 - heure_4)).count()/1e6 << "s" << endl;
    cout << "Sparse F:      " << (duration_cast<microseconds>(heure_6 - heure_5)).count()/1e6 << "s" << endl;
    cout << "Système Chol.: " << (duration_cast<microseconds>(heure_7 - heure_6)).count()/1e6 << "s" << endl;
    cout << "Résolut Chol.: " << (duration_cast<microseconds>(heure_8 - heure_7)).count()/1e6 << "s" << endl;
    cout << "Écriture depl: " << (duration_cast<microseconds>(heure_9 - heure_8)).count()/1e6 << "s" << endl;
    cout << "Écriture effo: " << (duration_cast<microseconds>(heure_10 - heure_9)).count()/1e6 << "s" << endl;
    cout << "Total:         " << (duration_cast<microseconds>(heure_10 - heure_0)).count()/1e6 << "s" << endl;
    
};

// VI - Fonction main, script du programme
// ---------------------------------------

int main() {

    double lh, lv, zInf, zSup, E, nu, t;
    int nb_coins;
    string extract;
    vector<point> lst_coins;

    ifstream rFile("input_batardeau.txt");
    
    rFile >> lh >> lv >> zInf >> zSup >> E >> nu >> t >> nb_coins;
    
    for (int k=0; k<nb_coins; k++){
        double x0,y0;
        rFile >> x0 >> y0;
        lst_coins.push_back(point(x0,y0,zInf));
    };
    lst_coins.push_back(lst_coins[0]);


    rFile.close();

    batardeau(lh,lv,zInf,zSup,lst_coins,nb_coins, E, nu, t);

    return 0;
};